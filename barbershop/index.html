<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Luca Barbershop - Frizerie Premium</title>
  <style>
    :root {
        --primary-black: #1a1a1a;
        --secondary-black: #2d2d2d;
        --accent-gold: #c6a55c;
        --text-white: #ffffff;
        --text-gray: #cccccc;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Poppins', sans-serif;
    }

    body {
        background-color: var(--primary-black);
        color: var(--text-white);
        line-height: 1.6;
    }

    header {
        background-color: var(--secondary-black);
        padding: 0.5rem 5%;
        position: fixed;
        width: 100%;
        top: 0;
        z-index: 1000;
    }

    nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .logo-container {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .logo-image {
        height: 80px;
        width: auto;
    }

    .logo {
        font-size: 2.5rem;
        font-weight: bold;
        color: var(--accent-gold);
    }

    .nav-links {
        display: flex;
        gap: 2rem;
    }

    .nav-links a {
        color: var(--text-white);
        text-decoration: none;
        transition: color 0.3s;
    }

    .nav-links a:hover {
        color: var(--accent-gold);
    }

    .hero {
        height: 100vh;
        background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)),
                    url('pozehudac/background.jpg') center 30% / cover;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 0 5%;
        position: relative;
    }

    .hero-content h1 {
        font-size: 4rem;
        margin-bottom: 1rem;
        color: var(--accent-gold);
    }

    .hero-content p {
        font-size: 1.2rem;
        color: var(--text-gray);
        margin-bottom: 2rem;
    }

    /* Chenar Programare */
    .booking-panel {
        position: fixed;
        right: 20px;
        top: 50%;
        transform: translateY(-50%);
        width: 350px;
        background: var(--secondary-black);
        border: 2px solid var(--accent-gold);
        border-radius: 15px;
        padding: 1.5rem;
        z-index: 999;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        max-height: 80vh;
        overflow-y: auto;
    }

    .booking-panel h3 {
        color: var(--accent-gold);
        text-align: center;
        margin-bottom: 1rem;
        font-size: 1.4rem;
    }

    .calendar-container {
        margin-bottom: 1rem;
    }

    .calendar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
    }

    .calendar-nav {
        background: var(--accent-gold);
        color: var(--primary-black);
        border: none;
        padding: 0.5rem;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
    }

    .calendar-month {
        color: var(--accent-gold);
        font-weight: bold;
    }

    .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 5px;
        margin-bottom: 1rem;
    }

    .calendar-day {
        background: var(--primary-black);
        color: var(--text-white);
        border: 1px solid var(--accent-gold);
        padding: 0.5rem;
        text-align: center;
        cursor: pointer;
        border-radius: 5px;
        transition: all 0.3s;
        font-size: 0.9rem;
    }

    .calendar-day:hover {
        background: var(--accent-gold);
        color: var(--primary-black);
    }

    .calendar-day.selected {
        background: var(--accent-gold);
        color: var(--primary-black);
        font-weight: bold;
    }

    .calendar-day.disabled {
        background: #555;
        color: #999;
        cursor: not-allowed;
    }

    .calendar-day.disabled:hover {
        background: #555;
        color: #999;
    }

    .day-header {
        color: var(--accent-gold);
        font-weight: bold;
        text-align: center;
        padding: 0.5rem;
        font-size: 0.8rem;
    }

    .time-slots {
        margin: 1rem 0;
        display: none;
    }

    .time-slots.active {
        display: block;
    }

    .time-slot {
        background: var(--primary-black);
        color: var(--text-white);
        border: 1px solid var(--accent-gold);
        padding: 0.7rem;
        margin: 0.3rem 0;
        text-align: center;
        cursor: pointer;
        border-radius: 5px;
        transition: all 0.3s;
    }

    .time-slot:hover {
        background: var(--accent-gold);
        color: var(--primary-black);
    }

    .time-slot.selected {
        background: var(--accent-gold);
        color: var(--primary-black);
        font-weight: bold;
    }

    .time-slot.occupied {
        background: #8b0000;
        color: #ccc;
        cursor: not-allowed;
        opacity: 0.6;
    }

    .time-slot.occupied:hover {
        background: #8b0000;
        color: #ccc;
    }

    .booking-form {
        margin-top: 1rem;
        display: none;
    }

    .booking-form.active {
        display: block;
    }

    .form-group {
        margin-bottom: 1rem;
    }

    .form-group label {
        display: block;
        color: var(--accent-gold);
        margin-bottom: 0.5rem;
        font-weight: bold;
    }

    .form-group input {
        width: 100%;
        padding: 0.7rem;
        background: var(--primary-black);
        color: var(--text-white);
        border: 1px solid var(--accent-gold);
        border-radius: 5px;
        font-size: 1rem;
    }

    .form-group input:focus {
        outline: none;
        border-color: var(--accent-gold);
        box-shadow: 0 0 5px rgba(198, 165, 92, 0.3);
    }

    .services {
        padding: 5rem 5%;
        background-color: var(--secondary-black);
    }

    .section-title {
        text-align: center;
        color: var(--accent-gold);
        font-size: 2.5rem;
        margin-bottom: 3rem;
    }

    .services-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        max-width: 1200px;
        margin: 0 auto;
    }

    .service-card {
        background-color: var(--primary-black);
        padding: 2rem;
        border-radius: 8px;
        text-align: center;
        transition: transform 0.3s;
    }

    .service-card:hover {
        transform: translateY(-5px);
    }

    .service-card h3 {
        color: var(--accent-gold);
        margin: 1rem 0;
    }

    .about {
        padding: 5rem 5%;
    }

    .about-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 4rem;
        align-items: center;
        max-width: 1200px;
        margin: 0 auto;
    }

    .about-image {
        width: 100%;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0,0,0,0.3);
    }

    .about-content h2 {
        color: var(--accent-gold);
        margin-bottom: 1.5rem;
    }

    .contact {
        padding: 5rem 5%;
        background-color: var(--secondary-black);
    }

    .contact-container {
        max-width: 1200px;
        margin: 0 auto;
    }

    .contact-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin-bottom: 2rem;
    }

    .contact-info {
        line-height: 2;
    }

    .contact-info h3 {
        color: var(--accent-gold);
        margin-bottom: 1rem;
    }

    .map-container {
        width: 100%;
        height: 400px;
        border-radius: 10px;
        overflow: hidden;
        display: none;
        margin-top: 2rem;
    }

    .map-container.active {
        display: block;
    }

    .btn {
        display: inline-block;
        padding: 1rem 2rem;
        background-color: var(--accent-gold);
        color: var(--primary-black);
        text-decoration: none;
        border-radius: 5px;
        font-weight: bold;
        transition: transform 0.3s;
        border: none;
        cursor: pointer;
        width: 100%;
        text-align: center;
        font-size: 1rem;
    }

    .btn:hover {
        transform: translateY(-3px);
    }

    .location-btn {
        display: block;
        margin: 0 auto;
        width: auto;
    }

    footer {
        background-color: var(--primary-black);
        padding: 2rem 5%;
        text-align: center;
        color: var(--text-gray);
    }

    .success-message {
        background: #4CAF50;
        color: white;
        padding: 1rem;
        border-radius: 5px;
        margin: 1rem 0;
        text-align: center;
        display: none;
    }

    .error-message {
        background: #f44336;
        color: white;
        padding: 1rem;
        border-radius: 5px;
        margin: 1rem 0;
        text-align: center;
        display: none;
    }

    @media (max-width: 768px) {
        .about-container {
            grid-template-columns: 1fr;
        }

        .hero-content h1 {
            font-size: 3rem;
        }

        .nav-links {
            display: none;
        }

        .booking-panel {
            position: relative;
            right: auto;
            top: auto;
            transform: none;
            width: 100%;
            margin: 2rem 0;
        }
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
<header>
  <nav>
    <div class="logo-container">
      <img src="pozehudac/logo.png" alt="Luca Barbershop Logo" class="logo-image">
      <div class="logo">Luca Barbershop</div>
    </div>
    <div class="nav-links">
      <a href="#home">Acasă</a>
      <a href="#services">Servicii</a>
      <a href="#about">Despre</a>
      <a href="#contact">Contact</a>
    </div>
  </nav>
</header>

<!-- Chenar Programare -->
<div class="booking-panel">
  <h3>Programează-te la tuns</h3>

  <div class="calendar-container">
    <div class="calendar-header">
      <button class="calendar-nav" onclick="changeMonth(-1)">‹</button>
      <div class="calendar-month" id="currentMonth"></div>
      <button class="calendar-nav" onclick="changeMonth(1)">›</button>
    </div>
    <div class="calendar-grid" id="calendarGrid"></div>
  </div>

  <div class="time-slots" id="timeSlots">
    <h4 style="color: var(--accent-gold); margin-bottom: 0.5rem;">Alege ora:</h4>
    <div id="timeSlotsList"></div>
  </div>

  <div class="booking-form" id="bookingForm">
    <div class="form-group">
      <label for="clientName">Nume complet:</label>
      <input type="text" id="clientName" required>
    </div>
    <div class="form-group">
      <label for="clientPhone">Număr de telefon:</label>
      <input type="tel" id="clientPhone" required>
    </div>
    <button class="btn" onclick="makeReservation()">Rezervă</button>
  </div>

  <div class="success-message" id="successMessage"></div>
  <div class="error-message" id="errorMessage"></div>
</div>

<section class="hero" id="home">
  <div class="hero-content">
    <h1>Luca Barbershop</h1>
    <p>Artă și profesionalism în fiecare tunsoare</p>
    <a href="#contact" class="btn">Programează-te acum</a>
  </div>
</section>

<section class="services" id="services">
  <h2 class="section-title">Serviciile Mele</h2>
  <div class="services-grid">
    <div class="service-card">
      <h3>Tuns Bărbătesc</h3>
      <p>Tunsori moderne sau clasice, adaptate stilului tău personal</p>
      <p class="price">de la 50 RON</p>
    </div>
    <div class="service-card">
      <h3>Aranjat Barbă</h3>
      <p>Îngrijire completă a bărbii, conturare și styling profesional</p>
      <p class="price">de la 35 RON</p>
    </div>
    <div class="service-card">
      <h3>Bărbierit Tradițional</h3>
      <p>Bărbierit cu briciul și tratament facial relaxant</p>
      <p class="price">de la 45 RON</p>
    </div>
    <div class="service-card">
      <h3>Pachet Complet</h3>
      <p>Tuns, aranjat barbă și îngrijire facială</p>
      <p class="price">de la 120 RON</p>
    </div>
  </div>
</section>

<section class="about" id="about">
  <div class="about-container">
    <img src="pozehudac/luca.jpg" alt="Luca - Master Barber" class="about-image">
    <div class="about-content">
      <h2>Despre Mine</h2>
      <p>Cu peste 10 ani de experiență în arta frizeriei, sunt dedicat să ofer clienților mei cele mai bune servicii și cele mai moderne stiluri. Fiecare client care îmi pășește în salon primește atenție personalizată și un look perfect adaptat personalității sale.</p>
      <p>Specializat în tunsori moderne și clasice, precum și în îngrijirea bărbii, folosesc cele mai bune tehnici și produse pentru a asigura rezultate excepționale de fiecare dată.</p>
      <a href="#contact" class="btn" style="margin-top: 1rem;">Contactează-mă</a>
    </div>
  </div>
</section>

<section class="contact" id="contact">
  <div class="contact-container">
    <h2 class="section-title">Contact & Program</h2>
    <div class="contact-grid">
      <div class="contact-info">
        <h3>Program</h3>
        <p>Luni - Vineri: 10:00 - 20:00</p>
        <p>Sâmbătă: 10:00 - 18:00</p>
        <p>Duminică: Închis</p>
      </div>
      <div class="contact-info">
        <h3>Contact</h3>
        <p>Telefon: 0722 123 456</p>
        <p>Email: contact@lucabarbershop.ro</p>
        <p>Adresă: Strada Exemplu nr. 123, București</p>
      </div>
    </div>

    <button class="btn location-btn" onclick="toggleMap()">Vezi Locația pe Hartă</button>

    <div class="map-container" id="mapContainer">
      <iframe
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2848.8485613461455!2d26.1019453!3d44.4267674!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x40b1ff4470220b8f%3A0x10c06031d35785cf!2sUniversitatea%20din%20Bucure%C8%99ti!5e0!3m2!1sro!2sro!4v1650000000000!5m2!1sro!2sro"
              allowfullscreen=""
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade">
      </iframe>
    </div>
  </div>
</section>

<footer>
  <p>&copy; 2024 Luca Barbershop. Toate drepturile rezervate.</p>
</footer>

<script>
  let currentDate = new Date();
  let selectedDate = null;
  let selectedTime = null;
  const API_BASE = 'http://localhost:3000/api';

  const timeSlots = ['09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00'];
  const months = ['Ianuarie', 'Februarie', 'Martie', 'Aprilie', 'Mai', 'Iunie',
                  'Iulie', 'August', 'Septembrie', 'Octombrie', 'Noiembrie', 'Decembrie'];
  const days = ['D', 'L', 'M', 'M', 'J', 'V', 'S'];

  // FUNCȚIA CHEIE PENTRU FIX-UL TIMEZONE
  function formatDateForAPI(date) {
    // Folosește getFullYear(), getMonth(), getDate() pentru a evita problemele de timezone
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0'); // +1 pentru că getMonth() returnează 0-11
    const day = String(date.getDate()).padStart(2, '0');

    return `${year}-${month}-${day}`;
  }

  function initializeCalendar() {
      renderCalendar();
  }

  function renderCalendar() {
      const year = currentDate.getFullYear();
      const month = currentDate.getMonth();

      document.getElementById('currentMonth').textContent = `${months[month]} ${year}`;

      const calendarGrid = document.getElementById('calendarGrid');
      calendarGrid.innerHTML = '';

      // Add day headers
      days.forEach(day => {
          const dayHeader = document.createElement('div');
          dayHeader.className = 'day-header';
          dayHeader.textContent = day;
          calendarGrid.appendChild(dayHeader);
      });

      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);
      const startDate = new Date(firstDay);
      startDate.setDate(startDate.getDate() - (firstDay.getDay() || 7) + 1);

      const today = new Date();
      today.setHours(0, 0, 0, 0);

      for (let i = 0; i < 42; i++) {
          const date = new Date(startDate);
          date.setDate(startDate.getDate() + i);

          const dayElement = document.createElement('div');
          dayElement.className = 'calendar-day';
          dayElement.textContent = date.getDate();

          if (date.getMonth() !== month) {
              dayElement.style.opacity = '0.3';
          }

          if (date < today) {
              dayElement.classList.add('disabled');
          } else {
              dayElement.onclick = () => selectDate(date);
          }

          calendarGrid.appendChild(dayElement);
      }
  }

  function changeMonth(direction) {
      currentDate.setMonth(currentDate.getMonth() + direction);
      renderCalendar();
  }

  function selectDate(date) {
      // Remove previous selection
      document.querySelectorAll('.calendar-day').forEach(day => {
          day.classList.remove('selected');
      });

      // Add selection to clicked day
      event.target.classList.add('selected');

      selectedDate = date;

      // DEBUG: Vezi ce dată este selectată
      console.log('Data selectată:', date);
      console.log('Data formatată pentru API:', formatDateForAPI(date));

      loadTimeSlots(date);
  }

  async function loadTimeSlots(date) {
      // FOLOSEȘTE FUNCȚIA FIXATĂ PENTRU FORMATAREA DATEI
      const dateStr = formatDateForAPI(date);

      console.log('Încărcare slots pentru data:', dateStr); // DEBUG

      try {
          const response = await fetch(`${API_BASE}/bookings/${dateStr}`);
          const bookedSlots = await response.json();

          console.log('Slots ocupate:', bookedSlots); // DEBUG

          const timeSlotsContainer = document.getElementById('timeSlotsList');
          timeSlotsContainer.innerHTML = '';

          timeSlots.forEach(time => {
              const slot = document.createElement('div');
              slot.className = 'time-slot';
              slot.textContent = time;

              if (bookedSlots.includes(time)) {
                  slot.classList.add('occupied');
                  slot.textContent += ' (Ocupat)';
              } else {
                  slot.onclick = () => selectTime(time, slot);
              }

              timeSlotsContainer.appendChild(slot);
          });

          document.getElementById('timeSlots').classList.add('active');
      } catch (error) {
          console.error('Eroare la încărcarea orelor:', error);
          showError('Eroare la încărcarea orelor disponibile');
      }
  }

  function selectTime(time, element) {
      // Remove previous selection
      document.querySelectorAll('.time-slot').forEach(slot => {
          slot.classList.remove('selected');
      });

      // Add selection
      element.classList.add('selected');
      selectedTime = time;

      document.getElementById('bookingForm').classList.add('active');
  }

  async function makeReservation() {
      const name = document.getElementById('clientName').value.trim();
      const phone = document.getElementById('clientPhone').value.trim();

      if (!name || !phone) {
          showError('Vă rugăm să completați toate câmpurile');
          return;
      }

      if (!selectedDate || !selectedTime) {
          showError('Vă rugăm să selectați data și ora');
          return;
      }

      // FOLOSEȘTE FUNCȚIA FIXATĂ PENTRU FORMATAREA DATEI
      const dateStr = formatDateForAPI(selectedDate);

      const reservation = {
          date: dateStr, // Data formatată corect
          time: selectedTime,
          name: name,
          phone: phone
      };

      console.log('Trimite rezervarea:', reservation); // DEBUG

      try {
          const response = await fetch(`${API_BASE}/bookings`, {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json'
              },
              body: JSON.stringify(reservation)
          });

          if (response.ok) {
              const result = await response.json();
              console.log('Rezervare confirmată:', result); // DEBUG

              showSuccess(`Rezervarea a fost confirmată pentru ${selectedDate.toLocaleDateString('ro-RO')} la ora ${selectedTime}`);
              resetForm();
              loadTimeSlots(selectedDate); // Refresh time slots
          } else {
              const error = await response.json();
              console.error('Eroare server:', error);
              showError(error.message || 'Eroare la salvarea rezervării');
          }
      } catch (error) {
          console.error('Eroare de conexiune:', error);
          showError('Eroare de conexiune. Vă rugăm încercați din nou.');
      }
  }

  function resetForm() {
      document.getElementById('clientName').value = '';
      document.getElementById('clientPhone').value = '';
      document.getElementById('bookingForm').classList.remove('active');
      selectedTime = null;

      document.querySelectorAll('.time-slot').forEach(slot => {
          slot.classList.remove('selected');
      });
  }

  function showSuccess(message) {
      const successDiv = document.getElementById('successMessage');
      successDiv.textContent = message;
      successDiv.style.display = 'block';

      setTimeout(() => {
          successDiv.style.display = 'none';
      }, 5000);
  }

  function showError(message) {
      const errorDiv = document.getElementById('errorMessage');
      errorDiv.textContent = message;
      errorDiv.style.display = 'block';

      setTimeout(() => {
          errorDiv.style.display = 'none';
      }, 5000);
  }

  function toggleMap() {
      const mapContainer = document.getElementById('mapContainer');
      const button = document.querySelector('.location-btn');

      if (mapContainer.classList.contains('active')) {
          mapContainer.classList.remove('active');
          button.textContent = 'Vezi Locația pe Hartă';
      } else {
          mapContainer.classList.add('active');
          button.textContent = 'Ascunde Harta';
      }
  }

  // Initialize calendar when page loads
  document.addEventListener('DOMContentLoaded', initializeCalendar);
</script>
</body>
</html>